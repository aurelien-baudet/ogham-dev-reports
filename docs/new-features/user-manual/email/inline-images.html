<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<title>Attach and reference images</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<link rel="stylesheet" href="./asciidoctor.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script type="text/javascript" src="../..//javascripts/steps.js"></script>
<script type="text/javascript" src="../..//javascripts/sourcecode/source-utils.js"></script>
<script type="text/javascript" src="../..//javascripts/sourcecode/highlight-lines.js"></script>
<script type="text/javascript" src="../..//javascripts/sourcecode/collapse-lines.js"></script>
<script type="text/javascript" src="../..//javascripts/tabcontainer.js"></script>
<script type="text/javascript" src="../..//javascripts/toc.js"></script>
<link rel="stylesheet" type="text/css" href="../..//styles/custom-styles.css" />
<link rel="stylesheet" type="text/css" href="../..//styles/tabcontainer.css" />
<link rel="stylesheet" type="text/css" href="../..//styles/steps.css" />
<link rel="stylesheet" type="text/css" href="../..//styles/toc.css" />
<link rel="stylesheet" type="text/css" href="../..//styles/sourcecode/collapse-lines.css" />
<link rel="stylesheet" type="text/css" href="../..//styles/sourcecode/highlight-lines.css" />
</head>
<body class="book toc2 toc-left">
<div id="header">
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_attach_and_reference_images">Attach and reference images</a></li>
<li><a href="#_embed_using_data_url_scheme">Embed using data URL scheme</a></li>
<li><a href="#_skip_some_images">Skip some images</a></li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Images can be referenced externally but there are many constraints to do so.
You have to provide the URL of the image. However, while you are coding or testing
the feature that sends an email with images (for example testing account creation
with confirmation email), the URL must point to an existing and accessible image.
And even then, the email client might block those images for safety purpose (prevent
tracking). Not mentioning offline issues.</p>
</div>
<div class="paragraph">
<p>That&#8217;s why Ogham provides automatic inlining on local images. Therefore, no
need to use a server to serve the images and no need to configure the URLs
to point to those images. The images are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Either attached with the email and referenced in the HTML using a
<a href="https://tools.ietf.org/html/rfc2392">Content-ID</a>.</p>
</li>
<li>
<p>Or images are converted to a base64 string and embedded in the HTML using the
<a href="https://tools.ietf.org/html/rfc2397">data URL scheme</a></p>
</li>
<li>
<p>Or not inlined at all (if the image points to an external URL or it is explicitly
skipped)</p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title">More explanation</div>
<div class="paragraph">
<p><a href="https://blog.mailtrap.io/embedding-images-in-html-email-have-the-rules-changed/">Additional information about image inlining</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title">Sender implementation independent</div>
<div class="paragraph">
<p>Inlining of images not only work when sending an email using Java Mail but also
works for any other email sender (like SendGrid).</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_attach_and_reference_images"><a class="anchor" href="#_attach_and_reference_images"></a>Attach and reference images</h2>
<div class="sectionbody">
<div class="paragraph">
<p>By default, if the HTML contains <code>&lt;img&gt;</code> tag with <code>src</code> attribute that points
to a local image, the image is automatically attached and referenced using a
<a href="https://tools.ietf.org/html/rfc2392">Content-ID</a> that is automatically generated.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Default choice explanation</div>
<div class="paragraph">
<p>The attach strategy has been chosen by default as it is handled by more email
clients than base64 strategy.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title">Customize CID generation</div>
<div class="paragraph">
<p>Default Content-ID generation simply uses a incremental number. It is possible to
use <a href="../../user-manual.html#custom-cid-generation">custom Content-ID generation</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>As Ogham is fully configurable, the default strategy can be changed. Therefore
if you want to use this strategy for a particular image, you need to explicitly
indicate it. You can do so by setting the <code>data-inline-image</code> attribute with
the <code>"attach"</code> value directly on the <code>&lt;img&gt;</code> tag.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title">Change default strategy</div>
<div class="paragraph">
<p>It is possible to configure Ogham to use a
<a href="../../user-manual.html#custom-image-inlining-strategy">different inlining strategy by default</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph tab-container  no-max-height">
<p>Attach images</p>
</div>
<div class="paragraph tab">
<p><span class="image"><img src="../../images//icons/java-logo.png" alt="java logo" width="16" height="30"></span> Java</p>
</div>
<div class="listingblock collapse-lines:1-10,12-28,36-48 irrelevant-lines:1-10,12-19 highlight-lines:30-31">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package fr.sii.ogham.sample.standard.email;

import java.util.Properties;

import fr.sii.ogham.core.builder.MessagingBuilder;
import fr.sii.ogham.core.exception.MessagingException;
import fr.sii.ogham.core.service.MessagingService;
import fr.sii.ogham.email.message.Email;

public class HtmlWithImagesAndCssTemplateSample {
  public static void main(String[] args) throws MessagingException {
    // configure properties (could be stored in a properties file or defined
    // in System properties)
    Properties properties = new Properties();
    properties.setProperty("mail.smtp.host", "&lt;your server host&gt;");
    properties.setProperty("mail.smtp.port", "&lt;your server port&gt;");
    properties.setProperty("ogham.email.from.default-value", "&lt;email address to display for the sender user&gt;");
    // Instantiate the messaging service using default behavior and
    // provided properties
    MessagingService service = MessagingBuilder.standard()
        .environment()
          .properties(properties)
          .and()
        .build();
    // send the email using fluent API
    // Note that the extension of the template is not given. This version
    // automatically takes the provided path and adds the '.html' extension
    // for the HTML template and '.txt.ftl' for text template
    service.send(new Email()
            .body().template("classpath:/template/withImagesAndCss/resources",    <i class="conum" data-value="1"></i><b>(1)</b>
                              new SimpleBean("foo", 42))        <i class="conum" data-value="2"></i><b>(2)</b>
            .to("ogham-test@yopmail.com"));
  }

  public static class SimpleBean {
    private String name;
    private int value;
    public SimpleBean(String name, int value) {
      super();
      this.name = name;
      this.value = value;
    }
    public String getName() {
      return name;
    }
    public int getValue() {
      return value;
    }
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The path to the templates (<code>/template/withImagesAndCss/resources.html</code> for the main body,
<code>/template/withImagesAndCss/resources.txt.ftl</code> for the text alternative)</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The template context</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><a href="https://github.com/groupe-sii/ogham/blob/master/sample-standard-usage/src/main/java/fr/sii/ogham/sample/standard/email/HtmlWithImagesAndCssTemplateSample.java?ts=2">Source code of the sample</a></p>
</div>
<div class="paragraph tab">
<p><span class="image"><img src="../../images//icons/thymeleaf-html.jpg" alt="thymeleaf html" width="30" height="30"></span> ThymeLeaf template</p>
</div>
<div class="listingblock collapse-lines:1-10,14-16,19-24,28-36,41-49 highlight-lines:12,27,39">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;!DOCTYPE html&gt;
&lt;html xmlns:th="http://www.thymeleaf.org"&gt;
&lt;head&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;
&lt;title&gt;HtmlWithImagesAndCssTemplateSample&lt;/title&gt;
&lt;meta name="viewport" content="width=device-width, initial-scale=1.0" /&gt;
&lt;link href="css/layout.css" rel="stylesheet" /&gt;                             <i class="conum" data-value="1"></i><b>(1)</b>
&lt;link href="css/theme.css" rel="stylesheet" /&gt;                              <i class="conum" data-value="2"></i><b>(2)</b>
&lt;/head&gt;
&lt;body&gt;
  &lt;header&gt;
    &lt;img src="images/h1.gif" alt="Creating Email Magic" /&gt;                      <i class="conum" data-value="3"></i><b>(3)</b>
  &lt;/header&gt;
  &lt;div class="content"&gt;
    &lt;span th:text="${name}"&gt;name&lt;/span&gt;
    &lt;p th:text="${value}"&gt;value&lt;/p&gt;
    &lt;div class="left"&gt;
      &lt;img src="images/left.gif" data-inline-image="base64" /&gt;                  <i class="conum" data-value="4"></i><b>(4)</b>
      &lt;p class="text"&gt;
        Lorem ipsum dolor sit amet, consectetur adipiscing elit. In
        tempus adipiscing felis, sit amet blandit ipsum volutpat sed. Morbi
        porttitor, eget accumsan dictum, nisi libero ultricies ipsum, in
        posuere mauris neque at erat.
      &lt;/p&gt;
    &lt;/div&gt;
    &lt;div class="right"&gt;
      &lt;img src="images/right.gif" data-inline-image="attach" /&gt;                 <i class="conum" data-value="5"></i><b>(5)</b>
      &lt;p class="text"&gt;
        Lorem ipsum dolor sit amet, consectetur adipiscing elit. In
        tempus adipiscing felis, sit amet blandit ipsum volutpat sed. Morbi
        porttitor, eget accumsan dictum, nisi libero ultricies ipsum, in
        posuere mauris neque at erat.
      &lt;/p&gt;
    &lt;/div&gt;
  &lt;/div&gt;
  &lt;footer&gt;
    &lt;div class="social"&gt;
      &lt;a href="http://www.twitter.com/"&gt;
        &lt;img src="images/tw.gif" alt="Twitter" /&gt;                       <i class="conum" data-value="6"></i><b>(6)</b>
      &lt;/a&gt;
      &lt;a href="http://www.facebook.com/"&gt;
        &lt;img src="images/fb.gif" alt="Facebook" data-inline-image="skip" /&gt;           <i class="conum" data-value="7"></i><b>(7)</b>
      &lt;/a&gt;
    &lt;/div&gt;
    &lt;div class="sender-info"&gt;
      &amp;reg; Someone, somewhere 2013&lt;br /&gt;
      &lt;a href="#" class="white" data-inline-styles="skip"&gt;Unsubscribe&lt;/a&gt; to this newsletter instantly  <i class="conum" data-value="8"></i><b>(8)</b>
    &lt;/div&gt;
  &lt;/footer&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>_</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>_</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>As nothing is specified and <code>src</code> points to a local image, the image will
be inlined (using <code>attach</code> strategy)</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>_</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Same as &lt;3&gt; but strategy is explicitly indicated</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Same as &lt;3&gt;</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><a href="https://github.com/groupe-sii/ogham/blob/master/sample-standard-usage/src/main/resources/template/withImagesAndCss/resources.html?ts=2">Source code of the HTML template</a></p>
</div>
<div class="paragraph tab">
<p><span class="image"><img src="../../images//icons/html.png" alt="html" width="37" height="30"></span> Generated HTML</p>
</div>
<div class="listingblock collapse-lines:1-8,12-24,27-34,39-47 highlight-lines:10,26,37">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;!doctype html&gt;
&lt;html&gt;
&lt;head&gt;                                                <i class="conum" data-value="1"></i><b>(1)</b>
&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8"&gt;
&lt;title&gt;Demystifying Email Design&lt;/title&gt;
&lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;
&lt;/head&gt;
&lt;body style="margin: 10px auto 30px auto; width: 600px; border: 1px solid #ccc;"&gt;         <i class="conum" data-value="2"></i><b>(2)</b>
  &lt;header style="padding: 40px 30px; background: #70bbd9;"&gt;
    &lt;img src="cid:0" alt="Creating Email Magic" style="display: block; margin: auto;"&gt;      <i class="conum" data-value="3"></i><b>(3)</b>
  &lt;/header&gt;
  &lt;div class="content" style="padding: 40px 30px; text-align: justify;"&gt;              <i class="conum" data-value="4"></i><b>(4)</b>
    &lt;span&gt;foo&lt;/span&gt;
    &lt;p&gt;42&lt;/p&gt;
    &lt;div class="left" style="width: 250px; display: inline-block; margin-right: 36px;"&gt;
      &lt;img src="data:image/gif;base64,R0lGODlh+gCMANUAAOxRVfySUllNTaNvTPS1j
            [...]
            K1KIa9ahITapSl8rUpjr1qVCNqlSHFAQAOw=="&gt;                   <i class="conum" data-value="5"></i><b>(5)</b>
      &lt;p class="text"&gt;Lorem ipsum dolor sit amet, consectetur
        adipiscing elit. In tempus adipiscing felis, sit amet blandit ipsum
        volutpat sed. Morbi porttitor, eget accumsan dictum, nisi libero
        ultricies ipsum, in posuere mauris neque at erat.
      &lt;/p&gt;
    &lt;/div&gt;
    &lt;div class="right" style="width: 250px; display: inline-block;"&gt;
      &lt;img src="cid:1"&gt;                                   <i class="conum" data-value="6"></i><b>(6)</b>
      &lt;p class="text"&gt;Lorem ipsum dolor sit amet, consectetur
        adipiscing elit. In tempus adipiscing felis, sit amet blandit ipsum
        volutpat sed. Morbi porttitor, eget accumsan dictum, nisi libero
        ultricies ipsum, in posuere mauris neque at erat.
      &lt;/p&gt;
    &lt;/div&gt;
  &lt;/div&gt;
  &lt;footer style="padding: 30px; color: #ffffff; font-family: Arial, sans-serif; font-size: 14px; background: #ee4c50;"&gt;
    &lt;div class="social" style="text-align: center;"&gt;
      &lt;a href="http://www.twitter.com/" style="display: inline-block; color: #ffffff;"&gt;   <i class="conum" data-value="7"></i><b>(7)</b>
        &lt;img src="cid:2" alt="Twitter"&gt;                           <i class="conum" data-value="8"></i><b>(8)</b>
      &lt;/a&gt;
      &lt;a href="http://www.facebook.com/" style="display: inline-block; color: #ffffff;"&gt;    <i class="conum" data-value="9"></i><b>(9)</b>
        &lt;img src="images/fb.gif" alt="Facebook"&gt;                      <i class="conum" data-value="10"></i><b>(10)</b>
      &lt;/a&gt;
    &lt;/div&gt;
    &lt;div class="sender-info" style="text-align: center; margin-top: 20px;"&gt;
      &amp;reg; Someone, somewhere 2013 &lt;br&gt;
      &lt;a href="#" class="white"&gt;Unsubscribe&lt;/a&gt;to this newsletter instantly         <i class="conum" data-value="11"></i><b>(11)</b>
    &lt;/div&gt;
  &lt;/footer&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>_</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>_</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The image is attached and the generated Content-ID is <code>0</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>_</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>_</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>The image is attached and the generated Content-ID is <code>1</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>_</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>The image is attached and the generated Content-ID is <code>2</code>.</td>
</tr>
</table>
</div>
<div class="paragraph tab-container-end">
<p>-</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_embed_using_data_url_scheme"><a class="anchor" href="#_embed_using_data_url_scheme"></a>Embed using data URL scheme</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As stated before, by default images are attached. So if you want to embed
an image directly as a base64 string, you need to set the <code>data-inline-image</code>
attribute with the <code>"base64"</code> value directly on the <code>&lt;img&gt;</code> tag.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Mimetype detection</div>
<div class="paragraph">
<p>The data URL scheme needs the mediatype information. Ogham automatically provides
this information for you thanks to <a href="../../user-manual.html#mimetype-detection">automatic mimetype detection</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph tab-container  no-max-height">
<p>Embed images as base64</p>
</div>
<div class="paragraph tab">
<p><span class="image"><img src="../../images//icons/java-logo.png" alt="java logo" width="16" height="30"></span> Java</p>
</div>
<div class="listingblock collapse-lines:1-10,12-28,36-48 irrelevant-lines:1-10,12-19 highlight-lines:30-31">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package fr.sii.ogham.sample.standard.email;

import java.util.Properties;

import fr.sii.ogham.core.builder.MessagingBuilder;
import fr.sii.ogham.core.exception.MessagingException;
import fr.sii.ogham.core.service.MessagingService;
import fr.sii.ogham.email.message.Email;

public class HtmlWithImagesAndCssTemplateSample {
  public static void main(String[] args) throws MessagingException {
    // configure properties (could be stored in a properties file or defined
    // in System properties)
    Properties properties = new Properties();
    properties.setProperty("mail.smtp.host", "&lt;your server host&gt;");
    properties.setProperty("mail.smtp.port", "&lt;your server port&gt;");
    properties.setProperty("ogham.email.from.default-value", "&lt;email address to display for the sender user&gt;");
    // Instantiate the messaging service using default behavior and
    // provided properties
    MessagingService service = MessagingBuilder.standard()
        .environment()
          .properties(properties)
          .and()
        .build();
    // send the email using fluent API
    // Note that the extension of the template is not given. This version
    // automatically takes the provided path and adds the '.html' extension
    // for the HTML template and '.txt.ftl' for text template
    service.send(new Email()
            .body().template("classpath:/template/withImagesAndCss/resources",    <i class="conum" data-value="1"></i><b>(1)</b>
                              new SimpleBean("foo", 42))        <i class="conum" data-value="2"></i><b>(2)</b>
            .to("ogham-test@yopmail.com"));
  }

  public static class SimpleBean {
    private String name;
    private int value;
    public SimpleBean(String name, int value) {
      super();
      this.name = name;
      this.value = value;
    }
    public String getName() {
      return name;
    }
    public int getValue() {
      return value;
    }
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The path to the templates (<code>/template/withImagesAndCss/resources.html</code> for the main body,
<code>/template/withImagesAndCss/resources.txt.ftl</code> for the text alternative)</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The template context</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><a href="https://github.com/groupe-sii/ogham/blob/master/sample-standard-usage/src/main/java/fr/sii/ogham/sample/standard/email/HtmlWithImagesAndCssTemplateSample.java?ts=2">Source code of the sample</a></p>
</div>
<div class="paragraph tab">
<p><span class="image"><img src="../../images//icons/thymeleaf-html.jpg" alt="thymeleaf html" width="30" height="30"></span> ThymeLeaf template</p>
</div>
<div class="listingblock collapse-lines:1-16,19-24,26-49 highlight-lines:18">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;!DOCTYPE html&gt;
&lt;html xmlns:th="http://www.thymeleaf.org"&gt;
&lt;head&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;
&lt;title&gt;HtmlWithImagesAndCssTemplateSample&lt;/title&gt;
&lt;meta name="viewport" content="width=device-width, initial-scale=1.0" /&gt;
&lt;link href="css/layout.css" rel="stylesheet" /&gt;                             <i class="conum" data-value="1"></i><b>(1)</b>
&lt;link href="css/theme.css" rel="stylesheet" /&gt;                              <i class="conum" data-value="2"></i><b>(2)</b>
&lt;/head&gt;
&lt;body&gt;
  &lt;header&gt;
    &lt;img src="images/h1.gif" alt="Creating Email Magic" /&gt;                      <i class="conum" data-value="3"></i><b>(3)</b>
  &lt;/header&gt;
  &lt;div class="content"&gt;
    &lt;span th:text="${name}"&gt;name&lt;/span&gt;
    &lt;p th:text="${value}"&gt;value&lt;/p&gt;
    &lt;div class="left"&gt;
      &lt;img src="images/left.gif" data-inline-image="base64" /&gt;                  <i class="conum" data-value="4"></i><b>(4)</b>
      &lt;p class="text"&gt;
        Lorem ipsum dolor sit amet, consectetur adipiscing elit. In
        tempus adipiscing felis, sit amet blandit ipsum volutpat sed. Morbi
        porttitor, eget accumsan dictum, nisi libero ultricies ipsum, in
        posuere mauris neque at erat.
      &lt;/p&gt;
    &lt;/div&gt;
    &lt;div class="right"&gt;
      &lt;img src="images/right.gif" data-inline-image="attach" /&gt;                 <i class="conum" data-value="5"></i><b>(5)</b>
      &lt;p class="text"&gt;
        Lorem ipsum dolor sit amet, consectetur adipiscing elit. In
        tempus adipiscing felis, sit amet blandit ipsum volutpat sed. Morbi
        porttitor, eget accumsan dictum, nisi libero ultricies ipsum, in
        posuere mauris neque at erat.
      &lt;/p&gt;
    &lt;/div&gt;
  &lt;/div&gt;
  &lt;footer&gt;
    &lt;div class="social"&gt;
      &lt;a href="http://www.twitter.com/"&gt;
        &lt;img src="images/tw.gif" alt="Twitter" /&gt;                       <i class="conum" data-value="6"></i><b>(6)</b>
      &lt;/a&gt;
      &lt;a href="http://www.facebook.com/"&gt;
        &lt;img src="images/fb.gif" alt="Facebook" data-inline-image="skip" /&gt;           <i class="conum" data-value="7"></i><b>(7)</b>
      &lt;/a&gt;
    &lt;/div&gt;
    &lt;div class="sender-info"&gt;
      &amp;reg; Someone, somewhere 2013&lt;br /&gt;
      &lt;a href="#" class="white" data-inline-styles="skip"&gt;Unsubscribe&lt;/a&gt; to this newsletter instantly  <i class="conum" data-value="8"></i><b>(8)</b>
    &lt;/div&gt;
  &lt;/footer&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>_</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>_</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>_</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Indicate to Ogham to inline using <code>base64</code> strategy</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><a href="https://github.com/groupe-sii/ogham/blob/master/sample-standard-usage/src/main/resources/template/withImagesAndCss/resources.html?ts=2">Source code of the HTML template</a></p>
</div>
<div class="paragraph tab">
<p><span class="image"><img src="../../images//icons/html.png" alt="html" width="37" height="30"></span> Generated HTML</p>
</div>
<div class="listingblock collapse-lines:1-14,19-23,25-47 highlight-lines:16-18">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;!doctype html&gt;
&lt;html&gt;
&lt;head&gt;                                                <i class="conum" data-value="1"></i><b>(1)</b>
&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8"&gt;
&lt;title&gt;Demystifying Email Design&lt;/title&gt;
&lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;
&lt;/head&gt;
&lt;body style="margin: 10px auto 30px auto; width: 600px; border: 1px solid #ccc;"&gt;         <i class="conum" data-value="2"></i><b>(2)</b>
  &lt;header style="padding: 40px 30px; background: #70bbd9;"&gt;
    &lt;img src="cid:0" alt="Creating Email Magic" style="display: block; margin: auto;"&gt;      <i class="conum" data-value="3"></i><b>(3)</b>
  &lt;/header&gt;
  &lt;div class="content" style="padding: 40px 30px; text-align: justify;"&gt;              <i class="conum" data-value="4"></i><b>(4)</b>
    &lt;span&gt;foo&lt;/span&gt;
    &lt;p&gt;42&lt;/p&gt;
    &lt;div class="left" style="width: 250px; display: inline-block; margin-right: 36px;"&gt;
      &lt;img src="data:image/gif;base64,R0lGODlh+gCMANUAAOxRVfySUllNTaNvTPS1j
            [...]
            K1KIa9ahITapSl8rUpjr1qVCNqlSHFAQAOw=="&gt;                   <i class="conum" data-value="5"></i><b>(5)</b>
      &lt;p class="text"&gt;Lorem ipsum dolor sit amet, consectetur
        adipiscing elit. In tempus adipiscing felis, sit amet blandit ipsum
        volutpat sed. Morbi porttitor, eget accumsan dictum, nisi libero
        ultricies ipsum, in posuere mauris neque at erat.
      &lt;/p&gt;
    &lt;/div&gt;
    &lt;div class="right" style="width: 250px; display: inline-block;"&gt;
      &lt;img src="cid:1"&gt;                                   <i class="conum" data-value="6"></i><b>(6)</b>
      &lt;p class="text"&gt;Lorem ipsum dolor sit amet, consectetur
        adipiscing elit. In tempus adipiscing felis, sit amet blandit ipsum
        volutpat sed. Morbi porttitor, eget accumsan dictum, nisi libero
        ultricies ipsum, in posuere mauris neque at erat.
      &lt;/p&gt;
    &lt;/div&gt;
  &lt;/div&gt;
  &lt;footer style="padding: 30px; color: #ffffff; font-family: Arial, sans-serif; font-size: 14px; background: #ee4c50;"&gt;
    &lt;div class="social" style="text-align: center;"&gt;
      &lt;a href="http://www.twitter.com/" style="display: inline-block; color: #ffffff;"&gt;   <i class="conum" data-value="7"></i><b>(7)</b>
        &lt;img src="cid:2" alt="Twitter"&gt;                           <i class="conum" data-value="8"></i><b>(8)</b>
      &lt;/a&gt;
      &lt;a href="http://www.facebook.com/" style="display: inline-block; color: #ffffff;"&gt;    <i class="conum" data-value="9"></i><b>(9)</b>
        &lt;img src="images/fb.gif" alt="Facebook"&gt;                      <i class="conum" data-value="10"></i><b>(10)</b>
      &lt;/a&gt;
    &lt;/div&gt;
    &lt;div class="sender-info" style="text-align: center; margin-top: 20px;"&gt;
      &amp;reg; Someone, somewhere 2013 &lt;br&gt;
      &lt;a href="#" class="white"&gt;Unsubscribe&lt;/a&gt;to this newsletter instantly         <i class="conum" data-value="11"></i><b>(11)</b>
    &lt;/div&gt;
  &lt;/footer&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>_</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>_</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>_</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>_</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>The data URL starts with <code>data:</code> followed by the mimetype (<code>image/gif</code>) and
the image converted to a base64 string (the base64 string is partially shown here
for readability).</td>
</tr>
</table>
</div>
<div class="paragraph tab-container-end">
<p>-</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_skip_some_images"><a class="anchor" href="#_skip_some_images"></a>Skip some images</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In the case you need to inline an image manually, you can tell Ogham to skip
the image by placing the <code>data-inline-image</code> attribute with the <code>"skip"</code> value
on the <code>&lt;img&gt;</code> tag.</p>
</div>
<div class="paragraph tab-container  no-max-height">
<p>Skip embedding</p>
</div>
<div class="paragraph tab">
<p><span class="image"><img src="../../images//icons/java-logo.png" alt="java logo" width="16" height="30"></span> Java</p>
</div>
<div class="listingblock collapse-lines:1-10,12-28,36-48 irrelevant-lines:1-10,12-19 highlight-lines:30-31">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package fr.sii.ogham.sample.standard.email;

import java.util.Properties;

import fr.sii.ogham.core.builder.MessagingBuilder;
import fr.sii.ogham.core.exception.MessagingException;
import fr.sii.ogham.core.service.MessagingService;
import fr.sii.ogham.email.message.Email;

public class HtmlWithImagesAndCssTemplateSample {
  public static void main(String[] args) throws MessagingException {
    // configure properties (could be stored in a properties file or defined
    // in System properties)
    Properties properties = new Properties();
    properties.setProperty("mail.smtp.host", "&lt;your server host&gt;");
    properties.setProperty("mail.smtp.port", "&lt;your server port&gt;");
    properties.setProperty("ogham.email.from.default-value", "&lt;email address to display for the sender user&gt;");
    // Instantiate the messaging service using default behavior and
    // provided properties
    MessagingService service = MessagingBuilder.standard()
        .environment()
          .properties(properties)
          .and()
        .build();
    // send the email using fluent API
    // Note that the extension of the template is not given. This version
    // automatically takes the provided path and adds the '.html' extension
    // for the HTML template and '.txt.ftl' for text template
    service.send(new Email()
            .body().template("classpath:/template/withImagesAndCss/resources",    <i class="conum" data-value="1"></i><b>(1)</b>
                              new SimpleBean("foo", 42))        <i class="conum" data-value="2"></i><b>(2)</b>
            .to("ogham-test@yopmail.com"));
  }

  public static class SimpleBean {
    private String name;
    private int value;
    public SimpleBean(String name, int value) {
      super();
      this.name = name;
      this.value = value;
    }
    public String getName() {
      return name;
    }
    public int getValue() {
      return value;
    }
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The path to the templates (<code>/template/withImagesAndCss/resources.html</code> for the main body,
<code>/template/withImagesAndCss/resources.txt.ftl</code> for the text alternative)</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The template context</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><a href="https://github.com/groupe-sii/ogham/blob/master/sample-standard-usage/src/main/java/fr/sii/ogham/sample/standard/email/HtmlWithImagesAndCssTemplateSample.java?ts=2">Source code of the sample</a></p>
</div>
<div class="paragraph tab">
<p><span class="image"><img src="../../images//icons/thymeleaf-html.jpg" alt="thymeleaf html" width="30" height="30"></span> ThymeLeaf template</p>
</div>
<div class="listingblock collapse-lines:1-40,44-49 highlight-lines:42">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;!DOCTYPE html&gt;
&lt;html xmlns:th="http://www.thymeleaf.org"&gt;
&lt;head&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;
&lt;title&gt;HtmlWithImagesAndCssTemplateSample&lt;/title&gt;
&lt;meta name="viewport" content="width=device-width, initial-scale=1.0" /&gt;
&lt;link href="css/layout.css" rel="stylesheet" /&gt;                             <i class="conum" data-value="1"></i><b>(1)</b>
&lt;link href="css/theme.css" rel="stylesheet" /&gt;                              <i class="conum" data-value="2"></i><b>(2)</b>
&lt;/head&gt;
&lt;body&gt;
  &lt;header&gt;
    &lt;img src="images/h1.gif" alt="Creating Email Magic" /&gt;                      <i class="conum" data-value="3"></i><b>(3)</b>
  &lt;/header&gt;
  &lt;div class="content"&gt;
    &lt;span th:text="${name}"&gt;name&lt;/span&gt;
    &lt;p th:text="${value}"&gt;value&lt;/p&gt;
    &lt;div class="left"&gt;
      &lt;img src="images/left.gif" data-inline-image="base64" /&gt;                  <i class="conum" data-value="4"></i><b>(4)</b>
      &lt;p class="text"&gt;
        Lorem ipsum dolor sit amet, consectetur adipiscing elit. In
        tempus adipiscing felis, sit amet blandit ipsum volutpat sed. Morbi
        porttitor, eget accumsan dictum, nisi libero ultricies ipsum, in
        posuere mauris neque at erat.
      &lt;/p&gt;
    &lt;/div&gt;
    &lt;div class="right"&gt;
      &lt;img src="images/right.gif" data-inline-image="attach" /&gt;                 <i class="conum" data-value="5"></i><b>(5)</b>
      &lt;p class="text"&gt;
        Lorem ipsum dolor sit amet, consectetur adipiscing elit. In
        tempus adipiscing felis, sit amet blandit ipsum volutpat sed. Morbi
        porttitor, eget accumsan dictum, nisi libero ultricies ipsum, in
        posuere mauris neque at erat.
      &lt;/p&gt;
    &lt;/div&gt;
  &lt;/div&gt;
  &lt;footer&gt;
    &lt;div class="social"&gt;
      &lt;a href="http://www.twitter.com/"&gt;
        &lt;img src="images/tw.gif" alt="Twitter" /&gt;                       <i class="conum" data-value="6"></i><b>(6)</b>
      &lt;/a&gt;
      &lt;a href="http://www.facebook.com/"&gt;
        &lt;img src="images/fb.gif" alt="Facebook" data-inline-image="skip" /&gt;           <i class="conum" data-value="7"></i><b>(7)</b>
      &lt;/a&gt;
    &lt;/div&gt;
    &lt;div class="sender-info"&gt;
      &amp;reg; Someone, somewhere 2013&lt;br /&gt;
      &lt;a href="#" class="white" data-inline-styles="skip"&gt;Unsubscribe&lt;/a&gt; to this newsletter instantly  <i class="conum" data-value="8"></i><b>(8)</b>
    &lt;/div&gt;
  &lt;/footer&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>_</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>_</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>_</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>_</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>_</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>_</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>Indicate to Ogham to skip inlining using <code>skip</code> value</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><a href="https://github.com/groupe-sii/ogham/blob/master/sample-standard-usage/src/main/resources/template/withImagesAndCss/resources.html?ts=2">Source code of the HTML template</a></p>
</div>
<div class="paragraph tab">
<p><span class="image"><img src="../../images//icons/html.png" alt="html" width="37" height="30"></span> Generated HTML</p>
</div>
<div class="listingblock collapse-lines:1-38,42-47 highlight-lines:40">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;!doctype html&gt;
&lt;html&gt;
&lt;head&gt;                                                <i class="conum" data-value="1"></i><b>(1)</b>
&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8"&gt;
&lt;title&gt;Demystifying Email Design&lt;/title&gt;
&lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;
&lt;/head&gt;
&lt;body style="margin: 10px auto 30px auto; width: 600px; border: 1px solid #ccc;"&gt;         <i class="conum" data-value="2"></i><b>(2)</b>
  &lt;header style="padding: 40px 30px; background: #70bbd9;"&gt;
    &lt;img src="cid:0" alt="Creating Email Magic" style="display: block; margin: auto;"&gt;      <i class="conum" data-value="3"></i><b>(3)</b>
  &lt;/header&gt;
  &lt;div class="content" style="padding: 40px 30px; text-align: justify;"&gt;              <i class="conum" data-value="4"></i><b>(4)</b>
    &lt;span&gt;foo&lt;/span&gt;
    &lt;p&gt;42&lt;/p&gt;
    &lt;div class="left" style="width: 250px; display: inline-block; margin-right: 36px;"&gt;
      &lt;img src="data:image/gif;base64,R0lGODlh+gCMANUAAOxRVfySUllNTaNvTPS1j
            [...]
            K1KIa9ahITapSl8rUpjr1qVCNqlSHFAQAOw=="&gt;                   <i class="conum" data-value="5"></i><b>(5)</b>
      &lt;p class="text"&gt;Lorem ipsum dolor sit amet, consectetur
        adipiscing elit. In tempus adipiscing felis, sit amet blandit ipsum
        volutpat sed. Morbi porttitor, eget accumsan dictum, nisi libero
        ultricies ipsum, in posuere mauris neque at erat.
      &lt;/p&gt;
    &lt;/div&gt;
    &lt;div class="right" style="width: 250px; display: inline-block;"&gt;
      &lt;img src="cid:1"&gt;                                   <i class="conum" data-value="6"></i><b>(6)</b>
      &lt;p class="text"&gt;Lorem ipsum dolor sit amet, consectetur
        adipiscing elit. In tempus adipiscing felis, sit amet blandit ipsum
        volutpat sed. Morbi porttitor, eget accumsan dictum, nisi libero
        ultricies ipsum, in posuere mauris neque at erat.
      &lt;/p&gt;
    &lt;/div&gt;
  &lt;/div&gt;
  &lt;footer style="padding: 30px; color: #ffffff; font-family: Arial, sans-serif; font-size: 14px; background: #ee4c50;"&gt;
    &lt;div class="social" style="text-align: center;"&gt;
      &lt;a href="http://www.twitter.com/" style="display: inline-block; color: #ffffff;"&gt;   <i class="conum" data-value="7"></i><b>(7)</b>
        &lt;img src="cid:2" alt="Twitter"&gt;                           <i class="conum" data-value="8"></i><b>(8)</b>
      &lt;/a&gt;
      &lt;a href="http://www.facebook.com/" style="display: inline-block; color: #ffffff;"&gt;    <i class="conum" data-value="9"></i><b>(9)</b>
        &lt;img src="images/fb.gif" alt="Facebook"&gt;                      <i class="conum" data-value="10"></i><b>(10)</b>
      &lt;/a&gt;
    &lt;/div&gt;
    &lt;div class="sender-info" style="text-align: center; margin-top: 20px;"&gt;
      &amp;reg; Someone, somewhere 2013 &lt;br&gt;
      &lt;a href="#" class="white"&gt;Unsubscribe&lt;/a&gt;to this newsletter instantly         <i class="conum" data-value="11"></i><b>(11)</b>
    &lt;/div&gt;
  &lt;/footer&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>_</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>_</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>_</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>_</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>_</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>_</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>_</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>_</td>
</tr>
<tr>
<td><i class="conum" data-value="9"></i><b>9</b></td>
<td>_</td>
</tr>
<tr>
<td><i class="conum" data-value="10"></i><b>10</b></td>
<td>The image is not inlined at all (the original <code>src</code> attribute is unchanged)</td>
</tr>
</table>
</div>
<div class="paragraph tab-container-end">
<p>-</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Future thoughts</div>
<div class="paragraph">
<p>In future version of Ogham, a new strategy may be added in order to automatically
serve local images and fill the HTML with the associated URL.</p>
</div>
<div class="paragraph">
<p>The images may be automatically served by:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>first uploading them somewhere before sending the email</p>
</li>
<li>
<p>automatically registering endpoints into your web application (adding Spring
controller for example) that uses Ogham</p>
</li>
<li>
<p>starting a local server (by running a command or a docker image for example)</p>
</li>
<li>
<p>using tools like ngrok to expose local files/http server</p>
</li>
<li>
<p>&#8230;&#8203;</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2020-07-28 13:24:59 UTC
</div>
</div>
</body>
</html>