<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<title>Explanation:</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<link rel="stylesheet" href="./asciidoctor.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script type="text/javascript" src="../..//javascripts/steps.js"></script>
<script type="text/javascript" src="../..//javascripts/sourcecode/source-utils.js"></script>
<script type="text/javascript" src="../..//javascripts/sourcecode/highlight-lines.js"></script>
<script type="text/javascript" src="../..//javascripts/sourcecode/collapse-lines.js"></script>
<script type="text/javascript" src="../..//javascripts/tabcontainer.js"></script>
<script type="text/javascript" src="../..//javascripts/toc.js"></script>
<script type="text/javascript" src="../..//javascripts/sticky-title-fix.js"></script>
<script type="text/javascript" src="../..//javascripts/image-viewer.js"></script>
<link rel="stylesheet" type="text/css" href="../..//styles/doc-styles.css" />
</head>
<body class="book toc2 toc-left">
<div id="header">
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_explanation">Explanation:</a></li>
<li><a href="#_solutions">Solutions:</a>
<ul class="sectlevel2">
<li><a href="#_either_prefer_use_of_old_javax_mail">Either prefer use of old Javax mail</a></li>
<li><a href="#_or_prefer_use_of_new_jakarta_mail">Or prefer use of new Jakarta mail</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="exampleblock tab-container no-max-height">
<div class="content">
<div class="openblock tab">
<div class="title"><span class="image"><img src="../../images//icons/maven-logo.png" alt="Maven" width="118" height="30"></span></div>
<div class="content">
<div class="listingblock collapse-lines:1-21,28- highlight-lines:22-26">
<div class="title">pom.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="preprocessor">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="tag">&lt;project</span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://maven.apache.org/POM/4.0.0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">&quot;</span></span>
  <span class="attribute-name">xsi:schemaLocation</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
  <span class="tag">&lt;modelVersion&gt;</span>4.0.0<span class="tag">&lt;/modelVersion&gt;</span>
  <span class="tag">&lt;parent&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>org.springframework.boot<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/artifactId&gt;</span>
    <span class="tag">&lt;version&gt;</span>2.3.3.RELEASE<span class="tag">&lt;/version&gt;</span>
    <span class="tag">&lt;relativePath</span><span class="tag">/&gt;</span> <span class="comment">&lt;!-- lookup parent from repository --&gt;</span>
  <span class="tag">&lt;/parent&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>samples<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>ogham-and-spring-boot<span class="tag">&lt;/artifactId&gt;</span>
  <span class="tag">&lt;version&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/version&gt;</span>
  <span class="tag">&lt;name&gt;</span>ogham-and-spring-boot<span class="tag">&lt;/name&gt;</span>
  <span class="tag">&lt;description&gt;</span>Demo project for Spring Boot<span class="tag">&lt;/description&gt;</span>

  <span class="tag">&lt;properties&gt;</span>
    <span class="tag">&lt;java.version&gt;</span>11<span class="tag">&lt;/java.version&gt;</span>
  <span class="tag">&lt;/properties&gt;</span>

  <span class="tag">&lt;dependencies&gt;</span>
    <span class="tag">&lt;dependency&gt;</span>
      <span class="tag">&lt;groupId&gt;</span>fr.sii.ogham<span class="tag">&lt;/groupId&gt;</span>
      <span class="tag">&lt;artifactId&gt;</span>ogham-spring-boot-starter-all<span class="tag">&lt;/artifactId&gt;</span>
      <span class="tag">&lt;version&gt;</span>4.0.0-SNAPSHOT<span class="tag">&lt;/version&gt;</span>
    <span class="tag">&lt;/dependency&gt;</span>

    <span class="tag">&lt;dependency&gt;</span>
      <span class="tag">&lt;groupId&gt;</span>org.springframework.boot<span class="tag">&lt;/groupId&gt;</span>
      <span class="tag">&lt;artifactId&gt;</span>spring-boot-starter-test<span class="tag">&lt;/artifactId&gt;</span>
      <span class="tag">&lt;scope&gt;</span>test<span class="tag">&lt;/scope&gt;</span>
      <span class="tag">&lt;exclusions&gt;</span>
        <span class="tag">&lt;exclusion&gt;</span>
          <span class="tag">&lt;groupId&gt;</span>org.junit.vintage<span class="tag">&lt;/groupId&gt;</span>
          <span class="tag">&lt;artifactId&gt;</span>junit-vintage-engine<span class="tag">&lt;/artifactId&gt;</span>
        <span class="tag">&lt;/exclusion&gt;</span>
      <span class="tag">&lt;/exclusions&gt;</span>
    <span class="tag">&lt;/dependency&gt;</span>
  <span class="tag">&lt;/dependencies&gt;</span>

  <span class="tag">&lt;build&gt;</span>
    <span class="tag">&lt;plugins&gt;</span>
      <span class="tag">&lt;plugin&gt;</span>
        <span class="tag">&lt;groupId&gt;</span>org.springframework.boot<span class="tag">&lt;/groupId&gt;</span>
        <span class="tag">&lt;artifactId&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/artifactId&gt;</span>
      <span class="tag">&lt;/plugin&gt;</span>
    <span class="tag">&lt;/plugins&gt;</span>
  <span class="tag">&lt;/build&gt;</span>

<span class="tag">&lt;/project&gt;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="openblock tab">
<div class="title"><span class="image"><img src="../../images//icons/gradlephant-logo.png" alt="Gradle" width="114" height="30"></span></div>
<div class="content">
<div class="listingblock collapse-lines:1-13,17-24 highlight-lines:16">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">plugins {
  id <span class="string"><span class="delimiter">'</span><span class="content">org.springframework.boot</span><span class="delimiter">'</span></span> version <span class="string"><span class="delimiter">'</span><span class="content">2.3.3.RELEASE</span><span class="delimiter">'</span></span>
  id <span class="string"><span class="delimiter">'</span><span class="content">io.spring.dependency-management</span><span class="delimiter">'</span></span> version <span class="string"><span class="delimiter">'</span><span class="content">1.0.10.RELEASE</span><span class="delimiter">'</span></span>
  id <span class="string"><span class="delimiter">'</span><span class="content">java</span><span class="delimiter">'</span></span>
}

group = <span class="string"><span class="delimiter">'</span><span class="content">samples</span><span class="delimiter">'</span></span>
version = <span class="string"><span class="delimiter">'</span><span class="content">0.0.1-SNAPSHOT</span><span class="delimiter">'</span></span>
sourceCompatibility = <span class="string"><span class="delimiter">'</span><span class="content">11</span><span class="delimiter">'</span></span>

repositories {
  mavenCentral()
}

dependencies {
  implementation <span class="string"><span class="delimiter">'</span><span class="content">fr.sii.ogham:ogham-spring-boot-starter-all:4.0.0-SNAPSHOT</span><span class="delimiter">'</span></span>

  testImplementation(<span class="string"><span class="delimiter">'</span><span class="content">org.springframework.boot:spring-boot-starter-test</span><span class="delimiter">'</span></span>) {
    exclude <span class="key">group</span>: <span class="string"><span class="delimiter">'</span><span class="content">org.junit.vintage</span><span class="delimiter">'</span></span>, <span class="key">module</span>: <span class="string"><span class="delimiter">'</span><span class="content">junit-vintage-engine</span><span class="delimiter">'</span></span>
  }
}

test {
  useJUnitPlatform()
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This will include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Sending email through SMTP server (using <a href="https://javaee.github.io/javamail/">JavaMail</a>)</p>
</li>
<li>
<p>Sending email through <a href="https://sendgrid.com/">SendGrid</a></p>
</li>
<li>
<p>Sending SMS through SMPP server (using <a href="https://github.com/fizzed/cloudhopper-smpp">Cloudhopper</a>)</p>
</li>
<li>
<p>Sending SMS through <a href="https://www.ovhtelecom.fr/sms/api-sms.xml">OVH SMS API</a></p>
</li>
<li>
<p><a href="http://freemarker.org/">FreeMarker</a> template engine available for building message contents</p>
</li>
<li>
<p><a href="http://www.thymeleaf.org/">ThymeLeaf</a> template engine available for building message contents</p>
</li>
<li>
<p>Support of <a href="https://projects.spring.io/spring-boot/">Spring Boot</a> auto-detection mechanism and configuration properties</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can combine Ogham with existing Spring Boot dependencies:</p>
</div>
<div class="exampleblock tab-container no-max-height">
<div class="title">Example 1. Ogham adapts itself to Spring Boot features</div>
<div class="content">
<div class="openblock tab">
<div class="title"><span class="image"><img src="../../images//icons/maven-logo.png" alt="Maven" width="118" height="30"></span></div>
<div class="content">
<div class="listingblock collapse-lines:1-21,40- highlight-lines:22-26">
<div class="title">pom.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="preprocessor">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="tag">&lt;project</span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://maven.apache.org/POM/4.0.0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">&quot;</span></span>
  <span class="attribute-name">xsi:schemaLocation</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
  <span class="tag">&lt;modelVersion&gt;</span>4.0.0<span class="tag">&lt;/modelVersion&gt;</span>
  <span class="tag">&lt;parent&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>org.springframework.boot<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/artifactId&gt;</span>
    <span class="tag">&lt;version&gt;</span>2.3.3.RELEASE<span class="tag">&lt;/version&gt;</span>
    <span class="tag">&lt;relativePath</span><span class="tag">/&gt;</span> <span class="comment">&lt;!-- lookup parent from repository --&gt;</span>
  <span class="tag">&lt;/parent&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>samples<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>ogham-and-spring-boot<span class="tag">&lt;/artifactId&gt;</span>
  <span class="tag">&lt;version&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/version&gt;</span>
  <span class="tag">&lt;name&gt;</span>ogham-and-spring-boot<span class="tag">&lt;/name&gt;</span>
  <span class="tag">&lt;description&gt;</span>Demo project for Spring Boot<span class="tag">&lt;/description&gt;</span>

  <span class="tag">&lt;properties&gt;</span>
    <span class="tag">&lt;java.version&gt;</span>11<span class="tag">&lt;/java.version&gt;</span>
  <span class="tag">&lt;/properties&gt;</span>

  <span class="tag">&lt;dependencies&gt;</span>
    <span class="tag">&lt;dependency&gt;</span>
      <span class="tag">&lt;groupId&gt;</span>fr.sii.ogham<span class="tag">&lt;/groupId&gt;</span>
      <span class="tag">&lt;artifactId&gt;</span>ogham-spring-boot-starter-all<span class="tag">&lt;/artifactId&gt;</span>    <i class="conum" data-value="1"></i><b>(1)</b>
      <span class="tag">&lt;version&gt;</span>4.0.0-SNAPSHOT<span class="tag">&lt;/version&gt;</span>
    <span class="tag">&lt;/dependency&gt;</span>

    <span class="tag">&lt;dependency&gt;</span>
      <span class="tag">&lt;groupId&gt;</span>org.springframework.boot<span class="tag">&lt;/groupId&gt;</span>
      <span class="tag">&lt;artifactId&gt;</span>spring-boot-starter-freemarker<span class="tag">&lt;/artifactId&gt;</span>   <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="tag">&lt;/dependency&gt;</span>
    <span class="tag">&lt;dependency&gt;</span>
      <span class="tag">&lt;groupId&gt;</span>org.springframework.boot<span class="tag">&lt;/groupId&gt;</span>
      <span class="tag">&lt;artifactId&gt;</span>spring-boot-starter-thymeleaf<span class="tag">&lt;/artifactId&gt;</span>    <i class="conum" data-value="3"></i><b>(3)</b>
    <span class="tag">&lt;/dependency&gt;</span>
    <span class="tag">&lt;dependency&gt;</span>
      <span class="tag">&lt;groupId&gt;</span>org.springframework.boot<span class="tag">&lt;/groupId&gt;</span>
      <span class="tag">&lt;artifactId&gt;</span>spring-boot-starter-mail<span class="tag">&lt;/artifactId&gt;</span>         <i class="conum" data-value="4"></i><b>(4)</b>
    <span class="tag">&lt;/dependency&gt;</span>

    <span class="tag">&lt;dependency&gt;</span>
      <span class="tag">&lt;groupId&gt;</span>org.springframework.boot<span class="tag">&lt;/groupId&gt;</span>
      <span class="tag">&lt;artifactId&gt;</span>spring-boot-starter-test<span class="tag">&lt;/artifactId&gt;</span>
      <span class="tag">&lt;scope&gt;</span>test<span class="tag">&lt;/scope&gt;</span>
      <span class="tag">&lt;exclusions&gt;</span>
        <span class="tag">&lt;exclusion&gt;</span>
          <span class="tag">&lt;groupId&gt;</span>org.junit.vintage<span class="tag">&lt;/groupId&gt;</span>
          <span class="tag">&lt;artifactId&gt;</span>junit-vintage-engine<span class="tag">&lt;/artifactId&gt;</span>
        <span class="tag">&lt;/exclusion&gt;</span>
      <span class="tag">&lt;/exclusions&gt;</span>
    <span class="tag">&lt;/dependency&gt;</span>
  <span class="tag">&lt;/dependencies&gt;</span>

  <span class="tag">&lt;build&gt;</span>
    <span class="tag">&lt;plugins&gt;</span>
      <span class="tag">&lt;plugin&gt;</span>
        <span class="tag">&lt;groupId&gt;</span>org.springframework.boot<span class="tag">&lt;/groupId&gt;</span>
        <span class="tag">&lt;artifactId&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/artifactId&gt;</span>
      <span class="tag">&lt;/plugin&gt;</span>
    <span class="tag">&lt;/plugins&gt;</span>
  <span class="tag">&lt;/build&gt;</span>

<span class="tag">&lt;/project&gt;</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Add Ogham starter for Spring Boot to benefit for all Ogham features in
your Spring Boot application.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Import FreeMarker starter as usual. Ogham will adapt to additional FreeMarker
provided by Spring Boot.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Import Thymeleaf starter as usual. Ogham will adapt to additional Thymeleaf
provided by Spring Boot.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Import Mail starter as usual. Ogham will adapt to use mail features provided
by Spring Boot.</td>
</tr>
</table>
</div>
</div>
</div>
<div class="openblock tab">
<div class="title"><span class="image"><img src="../../images//icons/gradlephant-logo.png" alt="Gradle" width="114" height="30"></span></div>
<div class="content">
<div class="listingblock collapse-lines:1-13,21-27 highlight-lines:16">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">plugins {
  id <span class="string"><span class="delimiter">'</span><span class="content">org.springframework.boot</span><span class="delimiter">'</span></span> version <span class="string"><span class="delimiter">'</span><span class="content">2.3.3.RELEASE</span><span class="delimiter">'</span></span>
  id <span class="string"><span class="delimiter">'</span><span class="content">io.spring.dependency-management</span><span class="delimiter">'</span></span> version <span class="string"><span class="delimiter">'</span><span class="content">1.0.10.RELEASE</span><span class="delimiter">'</span></span>
  id <span class="string"><span class="delimiter">'</span><span class="content">java</span><span class="delimiter">'</span></span>
}

group = <span class="string"><span class="delimiter">'</span><span class="content">samples</span><span class="delimiter">'</span></span>
version = <span class="string"><span class="delimiter">'</span><span class="content">0.0.1-SNAPSHOT</span><span class="delimiter">'</span></span>
sourceCompatibility = <span class="string"><span class="delimiter">'</span><span class="content">11</span><span class="delimiter">'</span></span>

repositories {
  mavenCentral()
}

dependencies {
  implementation <span class="string"><span class="delimiter">'</span><span class="content">fr.sii.ogham:ogham-spring-boot-starter-all:4.0.0-SNAPSHOT</span><span class="delimiter">'</span></span>   <i class="conum" data-value="1"></i><b>(1)</b>

  implementation <span class="string"><span class="delimiter">'</span><span class="content">org.springframework.boot:spring-boot-starter-freemarker</span><span class="delimiter">'</span></span>      <i class="conum" data-value="2"></i><b>(2)</b>
  implementation <span class="string"><span class="delimiter">'</span><span class="content">org.springframework.boot:spring-boot-starter-thymeleaf</span><span class="delimiter">'</span></span>       <i class="conum" data-value="3"></i><b>(3)</b>
  implementation <span class="string"><span class="delimiter">'</span><span class="content">org.springframework.boot:spring-boot-starter-mail</span><span class="delimiter">'</span></span>            <i class="conum" data-value="4"></i><b>(4)</b>
  testImplementation(<span class="string"><span class="delimiter">'</span><span class="content">org.springframework.boot:spring-boot-starter-test</span><span class="delimiter">'</span></span>) {
    exclude <span class="key">group</span>: <span class="string"><span class="delimiter">'</span><span class="content">org.junit.vintage</span><span class="delimiter">'</span></span>, <span class="key">module</span>: <span class="string"><span class="delimiter">'</span><span class="content">junit-vintage-engine</span><span class="delimiter">'</span></span>
  }
}

test {
  useJUnitPlatform()
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Add Ogham starter for Spring Boot to benefit for all Ogham features in
your Spring Boot application.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Import FreeMarker starter as usual. Ogham will adapt to additional FreeMarker
provided by Spring Boot.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Import Thymeleaf starter as usual. Ogham will adapt to additional Thymeleaf
provided by Spring Boot.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Import Mail starter as usual. Ogham will adapt to use mail features provided
by Spring Boot.</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Ogham will auto-configure to use Spring Boot additions and support Spring Boot
configuration properties like <code>spring.mail.host</code> for example.</p>
</div>
<div class="paragraph">
<p>Ogham is compatible with following Spring Boot versions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>1.4.x (currently automatically tested against 1.4.7.RELEASE, see note below)</p>
</li>
<li>
<p>1.5.x (currently automatically tested against 1.5.22.RELEASE)</p>
</li>
<li>
<p>2.1.x (currently automatically tested against 2.1.18.RELEASE)</p>
</li>
<li>
<p>2.2.x (currently automatically tested against 2.2.13.RELEASE)</p>
</li>
<li>
<p>2.3.x (currently automatically tested against 2.3.12.RELEASE)</p>
</li>
<li>
<p>2.4.x (currently automatically tested against 2.4.13)</p>
</li>
<li>
<p>2.5.x (currently automatically tested against 2.5.15)</p>
</li>
<li>
<p>2.6.x (currently automatically tested against 2.6.15)</p>
</li>
<li>
<p>2.7.x (currently automatically tested against 2.7.12)</p>
</li>
<li>
<p>3.0.x (currently automatically tested against 3.0.7)</p>
</li>
<li>
<p>3.1.x (currently automatically tested against 3.1.0)</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Java version compatibility</div>
<div class="paragraph">
<p>Ogham is compatible with Java 8 and up to Java 20 (included).</p>
</div>
<div class="paragraph">
<p>However, Spring Boot may not be compatible with some Java versions (depending on
Spring Boot version).</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
<div class="title">Spring Boot 2.2.x - 2.7.x</div>
<div class="paragraph">
<p>/!\ You may experience classpath issues while sending emails with Ogham using Java Mail and Spring Boot &gt;= 2.2.x &lt; 3.0.x.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_explanation"><a class="anchor" href="#_explanation"></a>Explanation:</h2>
<div class="sectionbody">
<div class="paragraph">
<p>There can be a mess in the classpath due to Spring Boot dependency management
that forces versions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Ogham uses the dependency <code>org.eclipse.angus:angus-mail &gt;= 2.0.1</code>, which imports:</p>
<div class="ulist">
<ul>
<li>
<p><code>jakarta.mail:jakarta.mail-api &gt;= 2.1.0</code></p>
</li>
<li>
<p><code>jakarta.activation:jakarta.activation-api &gt;= 2.1.1</code></p>
</li>
<li>
<p><code>org.eclipse.angus:angus-activation &gt;= 2.0.0</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>Spring Boot 2 dependency management forces these versions:</p>
<div class="ulist">
<ul>
<li>
<p><code>jakarta.mail:jakarta.mail-api &#8656; 1.6.7</code></p>
</li>
<li>
<p><code>jakarta.activation:jakarta.activation-api &#8656; 1.2.2</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>But, there is a mess in the packages. The dependency <code>jakarta.mail:jakarta.mail-api &#8656; 1.6.7</code>
declares classes in package <code>javax.mail</code> while <code>jakarta.mail:jakarta.mail-api &gt; 1.6.7</code>
declares classes in package <code>jakarta.mail</code>.
So, when using Ogham with Spring Boot 2, Ogham tries to adapt to what is present in the classpath:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>either Ogham tries to use Jakarta mail using <code>org.eclipse.angus:angus-mail &gt;= 2.0.1</code> but it fails
because it doesn&#8217;t find <code>jakarta.activation.DataHandler</code> (since in the classpath the
<code>jakarta.activation:jakarta.activation-api</code> version is <code>&#8656; 1.2.2</code> which defines
<code>javax.activation.DataHandler</code> instead).</p>
</li>
<li>
<p>or Ogham tries to use Javax mail using <code>jakarta.mail:jakarta.mail-api &#8656; 1.6.7</code>, but it may fail
because Ogham doesn&#8217;t bring Javax mail implementation dependencies to avoid classpath
mess and issues at runtime. So when trying to send en email using Javax mail, there is no implementation
available. But it is even worse than no implementation available. In the sources of
<code>jakarta.mail:jakarta.mail-api &#8656; 1.6.7</code>, there is a direct link to the Sun implementation
(at least <code>com.sun.mail.util.MailLogger</code>) which may not be present in the classpath.
So, instead of indicating that there is no Javax mail implementation present, it
fails with <code>java.lang.NoClassDefFoundError: com/sun/mail/util/MailLogger</code> which
is not really developer friendly and hard to understand why it happens.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_solutions"><a class="anchor" href="#_solutions"></a>Solutions:</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_either_prefer_use_of_old_javax_mail"><a class="anchor" href="#_either_prefer_use_of_old_javax_mail"></a>Either prefer use of old Javax mail</h3>
<div class="paragraph">
<p>If you prefer using Javax mail in order to avoid possible classpath clashes by mixing both javax and jakarta, you can:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Either add <code>org.springframework.boot:spring-boot-starter-mail</code> dependency  BEFORE <code>fr.sii.ogham:ogham-email-javamail</code> dependency.</p>
</li>
<li>
<p>Or add explicitly the dependency <code>com.sun.mail:jakarta.mail</code> BEFORE <code>fr.sii.ogham:ogham-email-javamail</code> dependency</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Order is important in order to let Java pick the service configuration of the <code>com.sun.mail:jakarta-mail</code> dependency first.
You can also exclude <code>org.eclipse.angus:angus-mail</code> from <code>fr.sii.ogham:ogham-email-javamail</code> (so that order doesn&#8217;t matter).</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_or_prefer_use_of_new_jakarta_mail"><a class="anchor" href="#_or_prefer_use_of_new_jakarta_mail"></a>Or prefer use of new Jakarta mail</h3>
<div class="paragraph">
<p>If you prefer using the new Jakarta mail, you can:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Either force Spring Boot dependency management to use newer versions by setting properties:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;properties&gt;</span>
    ...
    <span class="tag">&lt;jakarta-mail.version&gt;</span>2.1.1<span class="tag">&lt;/jakarta-mail.version&gt;</span>
    <span class="tag">&lt;jakarta-activation.version&gt;</span>2.1.1<span class="tag">&lt;/jakarta-activation.version&gt;</span>
    <span class="tag">&lt;sun-mail.version&gt;</span>2.0.1<span class="tag">&lt;/sun-mail.version&gt;</span>
    <span class="tag">&lt;sun-activation.version&gt;</span>2.0.1<span class="tag">&lt;/sun-activation.version&gt;</span>
    ...
<span class="tag">&lt;/properties&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Spring Boot dependency management uses the same property <code>${jakarta-activation.version}</code>
for both <code>jakarta.activation:jakarta.activation-api</code> and <code>com.sun.activation:jakarta.activation</code>.
So you also have to override dependency management by adding:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependencyManagement&gt;</span>
 <span class="tag">&lt;dependencies&gt;</span>
   <span class="tag">&lt;dependency&gt;</span>
     <span class="tag">&lt;groupId&gt;</span>com.sun.activation<span class="tag">&lt;/groupId&gt;</span>
     <span class="tag">&lt;artifactId&gt;</span>jakarta.activation<span class="tag">&lt;/artifactId&gt;</span>
     <span class="tag">&lt;version&gt;</span>${sun-activation.version}<span class="tag">&lt;/version&gt;</span>
   <span class="tag">&lt;/dependency&gt;</span>
 <span class="tag">&lt;/dependencies&gt;</span>
<span class="tag">&lt;/dependencyManagement&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Therefore, the property <code>${sun-activation.version}</code> has effect.</p>
</div>
</li>
<li>
<p>Or explicitly add dependencies to override Spring Boot inherited dependency management:</p>
<div class="ulist">
<ul>
<li>
<p><code>jakarta.activation:jakarta.mail-api:2.1.1</code></p>
</li>
<li>
<p><code>jakarta.activation:jakarta.activation-api:2.1.1</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Be careful yet, other Spring Boot modules may require <code>javax.activation</code> packages.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You can disable this message by setting the property <code>ogham.email.javamail.check-classpath-consistency=false</code></p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2023-05-25 15:18:35 UTC
</div>
</div>
<link rel="stylesheet" href="./coderay-asciidoctor.css">
</body>
</html>